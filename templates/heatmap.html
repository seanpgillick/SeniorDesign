{% block content %}
    <div class="site-header-logo">
        <h1 class="text-center">
            Heatmap
        </h1>
    </div>
    
    <div id="selections" class="flex-container">
        <form style="text-align:center" action="/mapUpdate/">
            <br>
                <div id="city-select">
                    <label for="cities-select">Select a City</label>
                    <select name="city" id="cities-select" single>
                        {% for o in cities %}
                            <option value="{{ o }}">{{ o }}</option>
                        {% endfor %}
                    </select>
                </div>
            <br>
                <div id="year-select">
                    <label for="years-select">Select a Year</label>
                    <select name="year" id="years-select" single>
                        <option value="All" selected>All</option>
                        {% for o in years %}
                            <option value="{{ o }}">{{ o }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div>
            <br>
                <div id="crime-select">
                    <label for="crimes-select">Select a Crime Type</label>
                    <select name="crime" id="crimes-select" single>
                        <option value="All" selected>All</option>
                        <option value="Violent">Violent</option>
                        <option value="Property">Propety</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
            <br>
            <div>
                <button>Update Heatmap</button>
            </div>
        </form>
        <div id="frameContainer">
        </div>
        
    </div>

    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script type="text/javascript">
    window.onload = function() {
        updateSrc();
        const urlParams = new URLSearchParams(window.location.search);
        document.getElementById("cities-select").value = urlParams.get('city');
        document.getElementById("years-select").value = urlParams.get('year');
        document.getElementById("crimes-select").value = urlParams.get('crime');
        console.log(urlParams.get('crime'));
    }
        function updateSrc() {
            let myIframe = document.createElement('iframe');
            myIframe.width=1350;
            myIframe.height=900;
            document.getElementById("frameContainer").innerHTML="";
            let url_string = "/mapGen";
            const urlParams = new URLSearchParams(window.location.search);
            const city = urlParams.get('city');
            const year = urlParams.get('year');
            const crime = urlParams.get('crime');

            let adsURL = url_string+"city="+city+"year="+year+"crime="+crime;
            console.log(adsURL);
            myIframe.src = adsURL;
            document.getElementById("frameContainer").appendChild(myIframe);
        }
    </script>
{% endblock %}
